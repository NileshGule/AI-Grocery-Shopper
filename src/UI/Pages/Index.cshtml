@page
@model UI.Pages.IndexModel

<h1>AI Grocery Shopper</h1>

<form method="post">
    <div>
        <label>Meal description</label>
        <input asp-for="Input.Description" />
    </div>
    <div>
        <label>Number of meals</label>
        <input type="number" asp-for="Input.NumberOfMeals" />
    </div>
    <div>
        <label>Dietary preferences (comma-separated)</label>
        <input asp-for="PreferencesRaw" />
    </div>
    <div>
        <label>Budget</label>
        <input type="number" step="0.01" asp-for="Input.Budget" />
    </div>
    <button type="submit">Generate</button>
</form>

@if (Model.Result != null)
{
    <h2>Steps</h2>
    <ul>
        @foreach (var s in Model.Result.Steps)
        {
            <li>@s</li>
        }
    </ul>

    <h2>Meal Plan</h2>
    @if (Model.Result.MealPlanResponse != null)
    {
        <ul>
            @foreach (var m in Model.Result.MealPlanResponse.Meals)
            {
                <li>
                    <strong>@m.Name</strong>
                    <div>Ingredients: @string.Join(", ", m.Ingredients)</div>
                    <div>Notes: @m.Notes</div>
                </li>
            }
        </ul>
    }

    <h2>Budget</h2>
    @if (Model.Result.BudgetResponse != null)
    {
        <div>Total: @Model.Result.BudgetResponse.TotalCost</div>
        <ul>
            @foreach (var item in Model.Result.BudgetResponse.Items)
            {
                <li>@item.Name - @item.Cost</li>
            }
        </ul>
    }

    <h2>Inventory</h2>
    @if (Model.Result.InventoryResponse != null)
    {
        <div>Available: @string.Join(", ", Model.Result.InventoryResponse.Available)</div>
        <div>Missing: @string.Join(", ", Model.Result.InventoryResponse.Missing)</div>
    }

    <h2>Shopping</h2>
    @if (Model.Result.ShopperResponse != null)
    {
        <div>Summary: @Model.Result.ShopperResponse.Summary</div>
        <ul>
            @foreach (var i in Model.Result.ShopperResponse.ShoppingList)
            {
                <li>@i</li>
            }
        </ul>
    }

    @if (Model.Result.Errors.Any())
    {
        <h3>Errors</h3>
        <ul>
            @foreach (var e in Model.Result.Errors)
            {
                <li>@e</li>
            }
        </ul>
    }
}
